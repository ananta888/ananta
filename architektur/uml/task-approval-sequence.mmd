sequenceDiagram
    participant User
    participant Angular as Angular SPA
    participant Hub as AI-Agent (hub)
    participant Worker as AI-Agent (worker)

    User->>Angular: Login (password + optional MFA)
    Angular->>Hub: POST /login
    Hub-->>Angular: access_token + refresh_token

    User->>Angular: Create Task / Edit
    Angular->>Hub: POST /tasks (create)
    Hub-->>Angular: Task created (id)

    Angular->>Hub: POST /tasks/{id}/propose (prompt?)
    Hub->>Worker: POST /step/propose
    Worker-->>Hub: { reason, command }
    Hub-->>Angular: { command }

    Angular->>Hub: POST /tasks/{id}/execute { command }
    Hub->>Worker: POST /step/execute { command, task_id }
    Worker-->>Hub: { exit_code, stdout }
    Angular->>Hub: GET /tasks/{id}/logs (poll)
    Hub-->>Angular: [ logs... ]
