version: "3.8"

services:
  controller:
    image: python:3.11-slim
    working_dir: /app
    volumes:
      - .:/app
    environment:
      - PYTHONPATH=/app
    command: >
      sh -c "pip install flask requests && python -m controller.controller"
    ports:
      - "8081:8081"

  ai-agent:
    image: python:3.11-slim
    working_dir: /app
    volumes:
      - .:/app
      - ./data:/data
    environment:
      - PYTHONPATH=/app
      - CONTROLLER_URL=http://host.docker.internal:8081
    ports:
      - "5678:5678"  # Port freigeben
    command: >
      sh -c "pip install debugpy && python -m debugpy --listen 0.0.0.0:5678 --wait-for-client agent/ai_agent.py"